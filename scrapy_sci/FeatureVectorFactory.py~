import numpy as np

class FeatureVectorFactory(object):
    
    def __init__(self, FeatureExtractor, data):
        self.FE = FE()
        self.aligned_features = {}
        for datum in data:
            self.aligned_features.update(FE.extract(datum))
        self.aligned_features = {key : 0.0 for key in self.aligned_features.keys()}
    
    def make_feature_vector(self, datum):
        fv = dict(self.aligned_features)
        fv.update(self.FE.extract(features))
        return np.array([fv[k] for k in self.aligned_features.keys()])
    
    
class WallpaperFeatures(FeatureExtractor):
    
    def __init__(self):
        super(WallpaperFeatures, self).__init__()
    
    
    def color_features(self, datum):
        features = {}
        for color in datum['colors']:
            features['color({0})'.format(color.encode('utf-8'))] = 1.0
        return features
    
    def descriptor_features(self, datum):
        features = {'named' : 0.0}
        for descriptor in datum['descriptors']:
            features["tag({0})".format(descriptor.encode('utf-8'))] = 1.0
            if descriptor.encode('utf-8')[0].isupper(): features['named'] = 1.0
        return features
